{% extends "sitebase.html" %}
{% load static %}

{# Cache busting for store updates #}
{% comment %}
Store Version: 2.0 - Modern Amazon Affiliate Implementation
Last Updated: 2025-06-28
Replaced deprecated Amazon widgets with Django product system
{% endcomment %}

{% block page_title %}Support The Close Call Database{% endblock %}

{% block content %}

<div class="jumbotron" style="padding-top: 20px;">

<h1 style="font-weight:600; font-size: 42px; padding-bottom: 28px">Support the Close Call Database</h1>

<p>
When I started the Close Call Database in November of 2014, I expected to pay the costs myself for about a year; then secure sponsors to cover expenses.
</p>

<p>
I was wrong.
</p>

<p>
It turns out that the mission here at Close Call Database isn't very attractive to sponsors because "the site reminds people that cycling is dangerous." It doesn't seem to matter that <em>everyone already knows that cycling is dangerous and that the entire point of the site is to make it less dangerous</em>.
</p>

<p>
If you want to support the database consider buying a camera or other item from the Amazon links below. After doing this for two years and reviewing over a thousand reports, it is my strong belief that on-bike video cameras are our best bet to improve safety quickly. Drivers are not going to suddenly stop aggressive behavior because they have the sudden moral revelation that it's not okay to play games of chance with someone else's life. The only thing that's going to stop aggressive drivers is the fear of getting caught and getting punished. When enough cyclists are riding with cameras, drivers are going to start to realize that the possibility of getting caught outweighs their desire to teach us that we "don't belong" on the road.
</p>

<p style="font-weight: 600;">When you buy cycling items using the links below, you help "keep the lights on" and keep the Close Call Database running.</p>

</div>

<div class="container">
    <!-- <h2 style="margin-bottom: 30px; font-weight: 700;">The CCDB "Storefront"</h2> -->
    
    {% if featured_products %}
    <div class="row">
        <!-- <div class="col-md-12">
            <p>When you buy cycling items from the links below, you help "keep the lights on" and keep the Close Call Database running.</p>
            <hr>
        </div> -->
        {% for product in featured_products %}
        <div class="col-md-4" style="margin-bottom: 30px;">
            <div class="well" style="min-height: 400px; text-align: center;">
                <!-- Product Image -->
                <div style="margin: 20px auto; width: 200px; height: 180px; overflow: hidden; border-radius: 8px; background-color: #f8f9fa;">
                    {% if product.image_url %}
                        <img src="{{ product.image_url }}" alt="{{ product.name }}" 
                             style="width: 100%; height: 100%; object-fit: contain; background: white;"
                             onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                        <!-- Fallback when image fails to load -->
                        <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border: 2px solid #dee2e6; display: none; flex-direction: column; align-items: center; justify-content: center; color: #6c757d;">
                            {% if product.category == 'cameras' %}
                                <div style="font-size: 48px; margin-bottom: 10px;">üìπ</div>
                            {% elif product.category == 'tires' %}
                                <div style="font-size: 48px; margin-bottom: 10px;">üö¥</div>
                            {% elif product.category == 'helmets' %}
                                <div style="font-size: 48px; margin-bottom: 10px;">ü™ñ</div>
                            {% elif product.category == 'accessories' %}
                                <div style="font-size: 48px; margin-bottom: 10px;">‚öôÔ∏è</div>
                            {% else %}
                                <div style="font-size: 48px; margin-bottom: 10px;">üõ°Ô∏è</div>
                            {% endif %}
                            <span style="font-size: 14px; font-weight: 500;">{{ product.get_category_display }}</span>
                        </div>
                    {% else %}
                        <!-- Category Icon Fallback -->
                        <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border: 2px solid #dee2e6; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #6c757d;">
                            {% if product.category == 'cameras' %}
                                <div style="font-size: 48px; margin-bottom: 10px;">üìπ</div>
                            {% elif product.category == 'tires' %}
                                <div style="font-size: 48px; margin-bottom: 10px;">üö¥</div>
                            {% elif product.category == 'helmets' %}
                                <div style="font-size: 48px; margin-bottom: 10px;">ü™ñ</div>
                            {% elif product.category == 'accessories' %}
                                <div style="font-size: 48px; margin-bottom: 10px;">‚öôÔ∏è</div>
                            {% else %}
                                <div style="font-size: 48px; margin-bottom: 10px;">üõ°Ô∏è</div>
                            {% endif %}
                            <span style="font-size: 14px; font-weight: 500;">{{ product.get_category_display }}</span>
                        </div>
                    {% endif %}
                </div>
                
                <div>
                    <h4 style="margin: 15px 0 10px 0;">{{ product.name }}</h4>
                    <p style="margin: 10px 0;"><strong>Category:</strong> {{ product.get_category_display }}</p>
                    <p style="margin: 15px 10px;">{{ product.description|truncatewords:18 }}</p>
                    <a href="{{ product.get_affiliate_url }}" target="_blank" class="btn btn-primary" style="margin-top: 10px;">View on Amazon</a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    
    {% if not featured_products %}
    <div class="row">
        <div class="col-md-12">
            <p class="alert alert-info">No products are currently available. Please check back later.</p>
        </div>
    </div>
    {% endif %}
</div>

<div class="container" style="margin-top: 40px;">
    <div class="row">
        <div class="col-md-12">
            <p class="text-muted">
                <small><strong>Amazon Associates Disclosure:</strong> The Close Call Database is a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for sites to earn advertising fees by advertising and linking to Amazon.com. As an Amazon Associate, we earn from qualifying purchases. Product prices and availability are accurate as of the date/time indicated and are subject to change.</small>
            </p>
        </div>
    </div>
</div>

{% endblock %}